2024-10-01 13:01:23,302 - INFO - Log directory: ./libcity/log
2024-10-01 13:01:23,302 - INFO - Begin pipeline, task=air_quality_pred, model_name=STGCN, dataset_name=City-Beijing-71P_Hour-2014-2017, exp_id=14172
2024-10-01 13:01:23,302 - INFO - {'task': 'air_quality_pred', 'model': 'STGCN', 'dataset': 'City-Beijing-71P_Hour-2014-2017', 'saved_model': True, 'train': True, 'seed': 0, 'load_external': False, 'pad_with_last_sample': False, 'scaler': 'minmax01', 'normal_external': True, 'ext_scaler': 'minmax01', 'train_rate': 0.5, 'eval_rate': 0.25, 'lr_patience': 10, 'distance_inverse': True, 'add_day_in_week': False, 'add_time_in_day': False, 'time_unit': 'Hour', 'preprocess': False, 'input_window': 24, 'output_window': 12, 'output_offset': 1, 'augmented_data': False, 'mixup': 'no_mixup', 'EMD': 'no_EMD', 'imf_num': 5, 'loss_type': 'ERM', 'weight_file': '34337', 'group_file': '34337', 'compute_metadata': False, 'features': ['PM2.5', 'PM10', 'SO2', 'NO2', 'CO', 'O3', 'U', 'V', 'TEMP', 'RH', 'PSFC'], 'point_metadata': ['PM2.5-target_val', 'PM2.5-temporal_state_vals', 'PM2.5-temporal_context_mean', 'PM2.5-temporal_context_trend', 'PM2.5-space_comp_state_vals', 'PM2.5-space_diff_state_vals'], 'anomaly_types': ['z_score_anomaly', 'neighbor_anomaly', 'temporal_anomaly'], 'focus_th': 115, 'focus_levels': [0, 35, 115, 250, 350, 500, 2000], 'forecast_scope': {'scope_mode': 'range', 'step_unit': 3, 'sample_method': 'log', 'sample_num': 4}, 'phase_params': {'min_len': 15, 'max_gap_len': 3, 'attributes': ['life_span', 'space_focus_cnt', 'time_val', 'time_focus_val', 'time_focus_cnt', 'focus_level_hist', 'mean_duration', 'mean_focus_grids', 'max_step_focus_grids', 'mean_intensity', 'max_step_intensity', 'max_value', 'step_centroids', 'mean_move_distance'], 'error_metrics': ['space_res_abs', 'res_distribution', 'phase_RMSE', 'phase_ACC', 'focus_level_accuracy', 'phase_POD', 'phase_FAR']}, 'event_params': {'connected_dis_th': 25, 'move_dis_th': 25, 'related_dis_th': 50, 'min_grid_num': 1, 'val_change_th': 0.1, 'area_change_th': 0.1, 'area_remain_th': 0.9, 'attributes': ['area_type', 'pre_area', 'change_area', 'intensity_type', 'pre_intensity', 'change_intensity', 'move_type', 'move_dis'], 'error_metrics': ['area_error', 'intensity_error', 'shift_error', 'union_points_error']}, 'distribution_params': {'val_step': 10, 'extreme_percentile': 95}, 'range_params': {'scope': 'Seg_Points', 'sup_th': 0.005, 'err_th': 5, 'bin_num': 8, 'step_len': {'PM2.5-target_val': 10, 'PM2.5-temporal_state_vals': 10, 'PM2.5-space_comp_state_vals': 10, 'PM2.5-space_diff_state_vals': 10, 'PM2.5-temporal_context_mean': 10, 'PM2.5-temporal_context_trend': 1}}, 'slice_params': {'data_scope': 'All_Data', 'mode': 'Polarity_Pruning', 'polarity': 'High_Error', 'frequent_sup_th': 0.001, 'err_diff_th': 5, 'err_th': 20, 'redundancy_th': 0.4, 'phase_id': 'None'}, 'exp_id': 14172, 'eval': False, 'dataset_class': 'AirQualityDataset', 'executor': 'AirQualityExecutor', 'evaluator': 'AirQualityEvaluator', 'Ks': 3, 'Kt': 3, 'blocks': [[1, 32, 64], [64, 128, 256]], 'dropout': 0.5, 'graph_conv_type': 'chebconv', 'stgcn_train_mode': 'quick', 'bidir_adj_mx': True, 'max_epoch': 120, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': True, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.7, 'steps': [5, 15, 30, 50, 70, 90, 110], 'clip_grad_norm': True, 'max_grad_norm': 1, 'use_early_stop': True, 'patience': 30, 'batch_size': 64, 'cache_dataset': True, 'num_workers': 0, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'metrics': ['MAE', 'MAPE', 'MSE', 'RMSE', 'masked_MAE', 'masked_MAPE', 'masked_MSE', 'masked_RMSE', 'R2', 'EVAR'], 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'distance': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'PM2.5': 'num', 'PM10': 'num', 'SO2': 'num', 'NO2': 'num', 'CO': 'num', 'O3': 'num', 'U': 'num', 'V': 'num', 'TEMP': 'num', 'RH': 'num', 'PSFC': 'num'}}, 'weight_col': 'distance', 'data_files': ['City-Beijing-71P_Hour-2014-2017'], 'geo_file': 'City-Beijing-71P_Hour-2014-2017', 'rel_file': 'City-Beijing-71P_Hour-2014-2017', 'output_dim': 1, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'device': device(type='cuda', index=0)}
2024-10-01 13:01:23,427 - INFO - Loaded file City-Beijing-71P_Hour-2014-2017.geo, num_nodes=71
2024-10-01 13:01:23,430 - INFO - Loading file City-Beijing-71P_Hour-2014-2017.dyna
